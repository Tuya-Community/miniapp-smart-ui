<wxs src="../wxs/utils.wxs" module="utils" />
<wxs src="./index.wxs" module="computed" />

<view
  class="{{ utils.bem('picker-column', { disabled }) }} custom-class"
  style="{{ computed.rootStyle({ itemHeight, visibleItemCount }) }}"
  options="{{options}}" 
  activeindex="{{activeIndex}}"
  loop="{{loop}}"
  valuekey="{{valueKey}}"
  itemheight="{{itemHeight}}"
  visibleitemcount="{{visibleItemCount}}"
  change:options="{{computed.updateValue('options')}}" 
  change:valuekey="{{computed.updateValue('valueKey')}}" 
  change:itemheight="{{computed.updateValue('itemHeight')}}" 
  change:visibleitemcount="{{computed.updateValue('visibleItemCount')}}" 
  change:activeindex="{{computed.updateValue('activeIndex')}}" 
  change:loop="{{computed.updateValue('loop')}}" 
  bind:touchstart="{{computed.touchStart}}"
  catch:touchmove="{{computed.touchMove}}"
  bind:touchend="{{computed.touchEnd}}"
  bind:touchcancel="{{computed.touchEnd}}"
>
  <view 
    id="options"
    class="smart-picker-column__offset" 
    style="height: {{ itemHeight * options.length }}px;{{ computed.wrapperStyle({ offset, itemHeight, visibleItemCount, animate, duration, renderStart, unit, loop }) }}" 
  >
    <view class="smart-picker-column__visual" style="{{ computed.wrapperInterStyle({ offset, itemHeight, visibleItemCount, renderStart }) }}">
      <view
        wx:for="{{ viewOptions }}"
        wx:for-item="option"
        wx:key="index"
        data-index="{{ index }}"
        style="{{computed.wrapperItemStyle({ itemHeight, fontStyle, activeStyle: renderStart + index === currentIndex ? activeStyle : '', animationIndex, index: renderStart + index, visibleItemCount })}}"
        class="smart-picker-column__item_{{index}} {{ computed.wrapperItemClass({ index, renderStart, animationIndex, option })}}"
      >
        <!-- {{ computed.optionText(option, valueKey) }} -->
      </view>
    </view>
  </view>
  <!-- <view class="smart-picker-column__mask">
    <view 
      wx:for="{{ visibleItemCount }}" 
      wx:key="index"
      class="smart-picker-column__mask__item" 
      data-index="{{ currentIndex + index - 2 }}" 
      bind:tap="onClickItem" 
    >
    </view>
  </view> -->
  <view wx:if="{{unit}}" class="smart-picker-column__unit" style="height: {{ itemHeight }}px">
    <view class="smart-picker-column__max-text">
      {{ maxText }}
      <view class="smart-picker-column__unit_text" >{{unit}}</view>
    </view>
  </view>
  
</view>
