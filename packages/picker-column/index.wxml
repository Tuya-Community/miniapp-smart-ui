<wxs src="../wxs/utils.wxs" module="utils" />
<wxs src="./index.wxs" module="computed" />

<view
  class="{{ utils.bem('picker-column', { disabled }) }} custom-class"
  style="{{ computed.rootStyle({ itemHeight, visibleItemCount }) }}"
  instanceId="{{instanceId}}"
  id="{{instanceId}}"
  data-options="{{options}}"
  data-valuekey="{{valueKey}}"
  data-itemheight="{{itemHeight}}"
  data-visibleitemcount="{{visibleItemCount}}"
  data-activeindex="{{activeIndex}}"
  data-loop="{{loop}}"
  data-animationtime="{{animationTime}}"
  options="{{options}}" 
  activeindex="{{activeIndex}}"
  loop="{{loop}}"
  valuekey="{{valueKey}}"
  itemheight="{{itemHeight}}"
  visibleitemcount="{{visibleItemCount}}"
  animationtime="{{animationTime}}"
  change:options="{{computed.updateValue(instanceId, 'options')}}" 
  change:valuekey="{{computed.updateValue(instanceId,'valueKey')}}" 
  change:itemheight="{{computed.updateValue(instanceId,'itemHeight')}}" 
  change:visibleitemcount="{{computed.updateValue(instanceId, 'visibleItemCount')}}" 
  change:activeindex="{{computed.updateValue(instanceId,'activeIndex')}}" 
  change:loop="{{computed.updateValue(instanceId,'loop')}}" 
  change:animationtime="{{computed.updateValue(instanceId,'animationTime')}}" 
  change:instanceid="{{computed.updateValue(instanceId,'instanceId')}}" 
  bind:touchstart="{{computed.touchStart(instanceId)}}"
  catch:touchmove="{{computed.touchMove(instanceId)}}"
  bind:touchend="{{computed.touchEnd(instanceId)}}"
  bind:touchcancel="{{computed.touchEnd(instanceId)}}"
>
  <view 
    id="options"
    class="smart-picker-column__offset" 
    style="height: {{ itemHeight * options.length }}px;{{ computed.wrapperStyle({ offset, itemHeight, visibleItemCount, animate, duration, renderStart, unit, loop }) }}" 
  >
    <view class="smart-picker-column__visual">
      <view class="smart-picker-column__visual__item_1">
        <view
          wx:for="{{ computed.sliceArray(viewOptions, 0, 10) }}"
          wx:key="index"
          data-index="{{item}}"
          style="{{computed.wrapperItemStyle({ itemHeight, animationIndex, index: item, visibleItemCount })}}"
          class="smart-picker-column__item_{{index}} {{ computed.wrapperItemClass({ index: item, animationIndex, options })}}"
          bind:tap="{{computed.tapItem(instanceId)}}" 
        >
          <view
            class="smart-picker-column__item__text"
            style="{{computed.wrapperItemTextStyle({ fontStyle, activeStyle, index: item, animationIndex })}}"
          ></view>
        </view>
      </view>
      <view class="smart-picker-column__visual__item_2">
        <view
          wx:for="{{ computed.sliceArray(viewOptions, 10) }}"
          wx:key="index"
          data-index="{{item}}"
          style="{{computed.wrapperItemStyle({ itemHeight, fontStyle, activeStyle: item === currentIndex ? activeStyle : '', animationIndex, index: item, visibleItemCount })}}"
          class="smart-picker-column__item_{{index + 10}} {{ computed.wrapperItemClass({ index: item, animationIndex, options })}}"
          bind:tap="{{computed.tapItem(instanceId)}}" 
        >
          <view
            class="smart-picker-column__item__text"
            style="{{computed.wrapperItemTextStyle({ fontStyle, activeStyle, index: item, animationIndex })}}"
          ></view>
        </view>
      </view>
    </view>
  </view>
  <view wx:if="{{unit}}" class="smart-picker-column__unit" style="height: {{ itemHeight }}px">
    <view class="smart-picker-column__max-text">
      {{ maxText }}
      <view class="smart-picker-column__unit_text" >{{unit}}</view>
    </view>
  </view>
  
</view>
